<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>book 예제</title>
<link href="../image/icon.png" rel="icon" type="image/x-icon" />

<link rel="stylesheet" href="../css/reset.css"/>
<link rel="stylesheet" href="../css/common.css"/>
</head>
<body>
	<h1 class="title">$.ajax()함수를 사용한 xml데이터 읽기- 예제</h1>
	<div class="console" id="result"></div>
		
	<script src="../js/jquery-3.7.1.min.js"></script>	
	<script>
		
		$.ajax({
			url: '/firstExample/ajax/xml/book.xml',
			method: 'get',
			dataType : 'xml'
		}).done(function(data){
		//데이터 추출
		$(data).find("book").each(function (){
		console.log($(this).index());
		let no = $(this).index()+1;
		let title = $(this).find("title").text();
		let author = $(this).find("author").text();
		let publish = $(this).find("publish").text();
		
		//동적 생성
		let div = $("<div>");
		let p1 = $("<p>").html(title);
		let p2 = $("<p>").html(author);
		let p3 = $("<p>").html(publish);
		
		//조합 및 출력
		div.append(no).append(p1).append(p2).append(p3);
		
		$("#result").append(div);
		$("#result").append("<hr/>");
		});
	}).fail(function(xhr, textStatus) {
		$("#result").html(textStatus) + " (HTTP-"+xhr.status + ")";
	});
		
		/* get() 함수로 접근 
		   $.get(요청할 url, 요청시 전달할 파라미터, 콜백함수) <-정상적으로 호출 시 호출함수
		   .fail(콜백함수)<- 실패시 호출 함수
		   같은 서버에 위치하고 있는 데이터를 요청하기 때문에 ../ajax/xml/book.xml 가능하다. 
		   하지만 다른 위치에서 접근시 경로가 달라져야 하기 때문에 uri 요청을 권장한다 */
		
		$.get('/firstExample/ajax/xml/book.xml',function(data){
			$(data).find('book').each(function(){
				let title = $(this).find("title").text();
				let author = $(this).find("author").text();
				let publish = $(this).find("publish").text();
			});
		}).fail(function(xhr, status) {
		    $("#result").html("오류가 발생했습니다.<br />").append("상태: " + status);
		});
	</script>
</body>
</html>